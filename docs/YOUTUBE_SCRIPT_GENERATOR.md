# YouTube Script Generator

Sistema inteligente que genera guiones optimizados para YouTube aprendiendo de videos exitosos en tiempo real.

## üìã Tabla de Contenidos

- [¬øQu√© es?](#qu√©-es)
- [¬øC√≥mo funciona?](#c√≥mo-funciona)
- [Instalaci√≥n](#instalaci√≥n)
- [Uso R√°pido](#uso-r√°pido)
- [Workflow Completo](#workflow-completo)
- [Configuraci√≥n](#configuraci√≥n)
- [Ejemplos](#ejemplos)
- [Troubleshooting](#troubleshooting)
- [Arquitectura](#arquitectura)

## ¬øQu√© es?

YouTube Script Generator es una herramienta que:

1. **Busca** los videos m√°s exitosos sobre un tema
2. **Analiza** sus patrones (hooks, estructura, CTAs, vocabulario)
3. **Sintetiza** las mejores pr√°cticas identificadas
4. **Genera** un gui√≥n profesional aplicando esos patrones

**Resultado**: Un gui√≥n de YouTube optimizado basado en datos reales de videos exitosos.

## ¬øC√≥mo funciona?

### Pipeline Completo (6 Fases)

```
Idea del usuario
    ‚Üì
1. Query Optimization (Gemini)
    ‚Üì "FastAPI tutorial Python REST API"
2. YouTube Search (yt-dlp)
    ‚Üì Top 10-15 videos por views/duraci√≥n
3. Batch Processing
    ‚îú‚îÄ Download (yt-dlp)
    ‚îî‚îÄ Transcribe (Whisper CUDA)
    ‚Üì 10-15 transcripciones completas
4. Pattern Analysis (Gemini)
    ‚îú‚îÄ Hooks efectivos
    ‚îú‚îÄ Estructura √≥ptima
    ‚îú‚îÄ CTAs estrat√©gicos
    ‚îî‚îÄ Vocabulario clave
    ‚Üì 10-15 an√°lisis individuales
5. Pattern Synthesis (Gemini)
    ‚îú‚îÄ Top 10 hooks
    ‚îú‚îÄ Mejores CTAs
    ‚îú‚îÄ T√©cnicas destacables
    ‚îî‚îÄ Keywords SEO
    ‚Üì 1 s√≠ntesis consolidada
6. Script Generation (Gemini)
    ‚îî‚îÄ Gui√≥n completo con timestamps
```

## Instalaci√≥n

### Requisitos Previos

- Python 3.9+
- FFmpeg (para procesamiento de audio)
- GPU CUDA (opcional, mejora velocidad de transcripci√≥n)
- API Key de Google Gemini

### Instalaci√≥n de Dependencias

```bash
# Clonar repositorio
git clone https://github.com/tu-usuario/yt-video-summarizer.git
cd yt-video-summarizer

# Instalar dependencias con UV (recomendado)
uv sync --extra dev

# O con pip tradicional
pip install -r requirements.txt
```

### Configuraci√≥n de API Keys

Crea un archivo `.env` en la ra√≠z del proyecto:

```bash
# .env
GOOGLE_API_KEY=tu_api_key_de_gemini
GEMINI_PRO_MODEL=gemini-2.0-flash-exp

# Whisper configuration (opcional)
WHISPER_MODEL_NAME=base
WHISPER_DEVICE=cuda
```

**Obtener API Key de Gemini:**
1. Ve a [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Crea un nuevo proyecto
3. Genera una API key
4. Copia la key al archivo `.env`

## Uso R√°pido

### Comando B√°sico

```bash
uv run python -m yt_transcriber.cli generate-script \
  --idea "crear una API REST con FastAPI desde cero"
```

### Con Opciones Personalizadas

```bash
uv run python -m yt_transcriber.cli generate-script \
  --idea "tutorial de Python para principiantes" \
  --max-videos 15 \
  --duration 12 \
  --min-duration 8 \
  --max-duration 20 \
  --style educational
```

### Argumentos Disponibles

| Argumento | Descripci√≥n | Default | Ejemplo |
|-----------|-------------|---------|---------|
| `--idea` (requerido) | Idea del video | - | `"crear API REST con FastAPI"` |
| `--max-videos` | N√∫mero de videos a analizar | 10 | `15` |
| `--duration` | Duraci√≥n objetivo del gui√≥n (min) | 10 | `12` |
| `--min-duration` | Duraci√≥n m√≠nima de videos a buscar | 5 | `8` |
| `--max-duration` | Duraci√≥n m√°xima de videos a buscar | 45 | `20` |
| `--style` | Preferencia de estilo | None | `educational`, `entertaining` |

## Workflow Completo

### 1. Query Optimization

El sistema optimiza tu idea para la b√∫squeda de YouTube:

**Input**: `"crear proyecto FastAPI"`
**Output**: `"FastAPI Python proyecto tutorial REST API beginners"`

- Usa Gemini para expandir keywords
- Elimina stopwords
- A√±ade t√©rminos relacionados

### 2. YouTube Search

Busca videos exitosos usando criterios optimizados:

- **Filtros**: Duraci√≥n (5-45 min), Views (descendente)
- **Ranking**: Quality score ponderado
- **Salida**: Top N videos ordenados por efectividad

### 3. Batch Processing

Descarga y transcribe videos en paralelo:

- **Download**: Extrae audio con yt-dlp
- **Transcribe**: Whisper con CUDA (23 seg/video en RTX 3060)
- **Cleanup**: Elimina archivos temporales autom√°ticamente

### 4. Pattern Analysis

Analiza cada video individualmente con Gemini:

**Patrones extra√≠dos:**
- **Hook**: Primeros 10-30 segundos (texto, tipo, efectividad)
- **Estructura**: Secciones con timestamps
- **CTAs**: Calls-to-action (tipo, posici√≥n, texto)
- **Vocabulario**: T√©rminos t√©cnicos, frases comunes
- **T√©cnicas**: Storytelling, ejemplos, analog√≠as
- **SEO**: Keywords en t√≠tulo y descripci√≥n

### 5. Pattern Synthesis

Consolida an√°lisis en un documento de mejores pr√°cticas:

**Synthesis incluye:**
- Top 10 hooks m√°s efectivos
- Estructura √≥ptima (promedio ponderado por views)
- CTAs m√°s frecuentes y sus posiciones
- Top 20 t√©rminos t√©cnicos del nicho
- T√©cnicas destacables de videos top
- Keywords SEO m√°s comunes

### 6. Script Generation

Genera gui√≥n completo aplicando patrones:

**El gui√≥n incluye:**
- Hook optimizado (basado en top hooks)
- Estructura con timestamps `[MM:SS]`
- 2-3 CTAs en posiciones estrat√©gicas
- Vocabulario del nicho
- SEO completo (t√≠tulo, descripci√≥n, tags)

## Configuraci√≥n

### Variables de Entorno

```bash
# Gemini API
GOOGLE_API_KEY=your_key_here
GEMINI_PRO_MODEL=gemini-2.0-flash-exp

# Whisper
WHISPER_MODEL_NAME=base  # tiny, base, small, medium, large
WHISPER_DEVICE=cuda      # cuda, cpu

# Logging
LOG_LEVEL=INFO           # DEBUG, INFO, WARNING, ERROR

# Directories (auto-created)
TEMP_DIR=temp_files
OUTPUT_DIR=output_transcripts
```

### Modelos Whisper

| Modelo | Velocidad | Precisi√≥n | VRAM | Uso Recomendado |
|--------|-----------|-----------|------|-----------------|
| `tiny` | ‚ö°‚ö°‚ö° | ‚≠ê‚≠ê | ~1GB | Pruebas r√°pidas |
| `base` | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê | ~1GB | **Default recomendado** |
| `small` | ‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê | ~2GB | Mejor precisi√≥n |
| `medium` | üêå | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ~5GB | Producci√≥n alta calidad |
| `large` | üêåüêå | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ~10GB | M√°xima precisi√≥n |

## Ejemplos

### Ejemplo 1: Tutorial de Programaci√≥n

```bash
uv run python -m yt_transcriber.cli generate-script \
  --idea "tutorial de FastAPI para principiantes" \
  --max-videos 12 \
  --duration 15 \
  --style educational
```

**Output esperado:**
- Gui√≥n de 15 minutos (~2,250 palabras)
- Hook tipo "pregunta" o "promesa"
- 3-4 secciones principales
- 2-3 CTAs (like, subscribe, comment)
- Vocabulario t√©cnico: FastAPI, async, Pydantic, etc.

### Ejemplo 2: Tutorial R√°pido

```bash
uv run python -m yt_transcriber.cli generate-script \
  --idea "configurar entorno Python en 5 minutos" \
  --max-videos 8 \
  --duration 6 \
  --min-duration 3 \
  --max-duration 10
```

**Output esperado:**
- Gui√≥n corto de 6 minutos (~900 palabras)
- Hook directo y r√°pido
- 2-3 secciones concisas
- Ritmo r√°pido, paso a paso

### Ejemplo 3: Contenido Entretenido

```bash
uv run python -m yt_transcriber.cli generate-script \
  --idea "los errores m√°s comunes en Python" \
  --max-videos 10 \
  --duration 12 \
  --style entertaining
```

**Output esperado:**
- Gui√≥n entretenido (~1,800 palabras)
- Hook con estad√≠stica o dato sorprendente
- Tono m√°s casual
- Storytelling y ejemplos divertidos

## Troubleshooting

### Error: "No videos found for query"

**Causa**: Los filtros de duraci√≥n son demasiado restrictivos.

**Soluci√≥n**:
```bash
# Ampl√≠a el rango de duraci√≥n
--min-duration 3 --max-duration 60
```

### Error: "CUDA not available"

**Causa**: PyTorch no detecta GPU CUDA.

**Soluci√≥n**:
```bash
# Reinstala PyTorch con CUDA
uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128 --force-reinstall

# O usa CPU (m√°s lento)
# En .env: WHISPER_DEVICE=cpu
```

### Error: "YouTube search timed out"

**Causa**: yt-dlp tard√≥ >60 segundos.

**Soluci√≥n**:
```bash
# Reduce max-videos
--max-videos 5

# O verifica conexi√≥n de red
```

### Error: "Gemini API quota exceeded"

**Causa**: L√≠mite de requests gratuitos alcanzado.

**Soluci√≥n**:
- Espera 24 horas (reset diario)
- Upgrade a plan pago de Gemini API
- Reduce `--max-videos` para menos API calls

### Advertencia: "Synthesis quality may be low"

**Causa**: Pocos videos analizados (<5).

**Soluci√≥n**:
```bash
# Aumenta max-videos
--max-videos 15
```

## Arquitectura

### M√≥dulos del Sistema

```
youtube_script_generator/
‚îú‚îÄ‚îÄ query_optimizer.py      # Optimiza b√∫squeda con Gemini
‚îú‚îÄ‚îÄ youtube_searcher.py     # Busca videos con yt-dlp
‚îú‚îÄ‚îÄ batch_processor.py      # Download + transcribe en batch
‚îú‚îÄ‚îÄ pattern_analyzer.py     # Analiza patrones de cada video
‚îú‚îÄ‚îÄ synthesizer.py          # Sintetiza m√∫ltiples an√°lisis
‚îú‚îÄ‚îÄ script_generator.py     # Genera gui√≥n final
‚îî‚îÄ‚îÄ models.py               # Dataclasses compartidas
```

### Dataclasses Principales

#### YouTubeVideo
```python
@dataclass
class YouTubeVideo:
    video_id: str
    title: str
    url: str
    duration_seconds: int
    view_count: int
    upload_date: str
    channel: str

    @property
    def quality_score(self) -> float:
        # Views (40%) + Duration (20%) + Recency (20%) + Completeness (20%)
```

#### VideoAnalysis
```python
@dataclass
class VideoAnalysis:
    video: YouTubeVideo

    # Structure
    hook_start: int
    hook_end: int
    hook_text: str
    hook_type: str  # question, statistic, promise, problem
    sections: list[dict]

    # CTAs
    ctas: list[dict]  # [{text, timestamp, type}]

    # Vocabulary
    technical_terms: list[str]
    common_phrases: list[str]

    # SEO
    title_keywords: list[str]
    estimated_tags: list[str]
```

#### PatternSynthesis
```python
@dataclass
class PatternSynthesis:
    topic: str
    num_videos_analyzed: int

    # Top patterns (weighted by quality_score)
    top_hooks: list[dict]
    optimal_structure: dict
    effective_ctas: list[dict]
    key_vocabulary: dict
    notable_techniques: list[dict]
    seo_patterns: dict

    # Report
    markdown_report: str
```

#### GeneratedScript
```python
@dataclass
class GeneratedScript:
    user_idea: str
    script_markdown: str
    estimated_duration_minutes: int
    word_count: int

    # SEO
    seo_title: str
    seo_description: str
    seo_tags: list[str]

    # Quality
    estimated_quality_score: int  # 1-100
```

### Flujo de Datos

```
User Input (idea)
    ‚Üì
QueryOptimizer ‚Üí OptimizedQuery
    ‚Üì
YouTubeSearcher ‚Üí list[YouTubeVideo]
    ‚Üì
BatchProcessor ‚Üí list[VideoTranscript]
    ‚Üì
PatternAnalyzer ‚Üí list[VideoAnalysis]
    ‚Üì
PatternSynthesizer ‚Üí PatternSynthesis
    ‚Üì
ScriptGenerator ‚Üí GeneratedScript
    ‚Üì
Output Files (.md)
```

## Costes Estimados

### Por Ejecuci√≥n (10 videos)

| Fase | API Calls | Tokens | Coste (Gemini 2.0 Flash) |
|------|-----------|--------|--------------------------|
| Query Optimization | 1 | ~500 | $0.001 |
| Pattern Analysis | 10 | ~50,000 | $0.050 |
| Synthesis | 1 | ~10,000 | $0.010 |
| Script Generation | 1 | ~5,000 | $0.005 |
| **TOTAL** | **13** | **~65,500** | **~$0.066** |

**Nota**: Con tier gratuito de Gemini (50 requests/d√≠a), puedes generar ~3 guiones/d√≠a gratis.

### Tiempo de Ejecuci√≥n (GPU RTX 3060)

| Fase | Tiempo/Video | Tiempo Total (10 videos) |
|------|--------------|--------------------------|
| Download | ~15s | ~2.5 min |
| Transcribe | ~23s | ~4 min |
| Analysis | ~5s | ~1 min |
| Synthesis | - | ~20s |
| Generation | - | ~15s |
| **TOTAL** | - | **~8-10 min** |

## Roadmap Futuro

### Mejoras Planificadas

- [ ] Soporte para m√∫ltiples idiomas
- [ ] Cache de an√°lisis para reutilizaci√≥n
- [ ] Interfaz web (Streamlit/Gradio)
- [ ] Exportaci√≥n a Google Docs
- [ ] Generaci√≥n de thumbnails sugeridos
- [ ] An√°lisis de sentimiento en comentarios
- [ ] Predicci√≥n de performance (views esperadas)

### Contribuciones

¬°Pull requests bienvenidos! Ver [CONTRIBUTING.md](../CONTRIBUTING.md) para guidelines.

## Licencia

MIT License - Ver [LICENSE](../LICENSE) para detalles.

## Soporte

- **Issues**: [GitHub Issues](https://github.com/tu-usuario/yt-video-summarizer/issues)
- **Discusiones**: [GitHub Discussions](https://github.com/tu-usuario/yt-video-summarizer/discussions)
- **Email**: tu-email@example.com

---

**¬øPreguntas?** Consulta primero la secci√≥n [Troubleshooting](#troubleshooting) o abre un issue en GitHub.
